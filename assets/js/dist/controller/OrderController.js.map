{"version":3,"sources":["../../src/controller/OrderController.js"],"names":["orderController","controller","Order","OrderList","OrderListView","OrderService","Message","MessageView","DateHelper","DataBind","OrderController","$","document","querySelector","bind","_controlsDate","_controlsAmount","_controlsPrice","_orderList","_message","_service","_init","event","preventDefault","add","_createOrder","then","text","message","_clearForm","catch","error","import","list","orders","forEach","order","delete","column","_currentColumn","inverse","arrange","a","b","load","date","dateFromText","value","amount","parseInt","price","parseFloat","focus"],"mappings":"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","file":"OrderController.js","sourcesContent":["import {Order} from '../model/Order';\nimport {OrderList} from '../model/OrderList';\nimport {OrderListView} from '../view/OrderListView.js';\nimport {OrderService} from '../service/OrderService';\nimport {Message} from '../model/Message';\nimport {MessageView} from '../view/MessageView';\nimport {DateHelper} from '../helper/DateHelper';\nimport {DataBind} from '../helper/DataBind';\n\nclass OrderController {\n\n    constructor() {\n\n        let $ = document.querySelector.bind(document);\n\n        this._controlsDate = $('#order-date');\n        this._controlsAmount = $('#order-amount');\n        this._controlsPrice = $('#order-price');\n\n        this._orderList = new DataBind(\n            new OrderList(),\n            new OrderListView($('#orderListView')),\n            'add', 'delete', 'inverse', 'arrange');\n        \n        this._message = new DataBind(\n            new Message(),\n            new MessageView($('#messageView')),\n            'text');\n        \n        this._service = new OrderService();\n\n        this._init();\n    }\n\n    add(event) {\n        \n        event.preventDefault();\n\n        this._service\n            .add(this._createOrder())\n            .then(message => {\n                this._orderList.add(this._createOrder());\n                this._message.text = message;\n                this._clearForm();\n            })\n            .catch(error => this._message.text = error);\n    }\n\n    import() {\n\n        this._service\n            .import(this._orderList.list)\n            .then(orders => {\n                orders.forEach(order => this._orderList.add(order))\n                this._message.text = 'Orders imported.';\n                this._clearForm();\n            })\n            .catch(error => this._message.text = error);\n    }\n\n    delete() {\n\n        this._service\n            .delete()\n            .then(message => {\n                this._orderList.delete();\n                this._message.text = message;\n                this._clearForm();\n            })\n            .catch(error => this._message.text = error);        \n    }\n\n    arrange(column) {\n\n        this._currentColumn == column\n            ? this._orderList.inverse()\n            : this._orderList.arrange((a, b) => a[column] - b[column]);\n        \n        this._currentColumn = column;\n    }\n\n    _init() {\n\n        this._service\n            .load()\n            .then(orders => orders.forEach(order => this._orderList.add(order)))\n            .catch(error => this._message.text = error);\n    }\n\n    _createOrder() {\n\n        let date = DateHelper.dateFromText(this._controlsDate.value);\n        let amount = parseInt(this._controlsAmount.value);\n        let price = parseFloat(this._controlsPrice.value)\n        \n        return new Order(date, amount, price);\n    }\n\n    _clearForm() {\n\n        this._controlsDate.value = '';\n        this._controlsAmount.value = 1;\n        this._controlsPrice.value = 0;\n\n        this._controlsDate.focus();\n    }\n}\n\nlet controller = new OrderController();\n\nexport function orderController() {\n    return controller;\n}"]}